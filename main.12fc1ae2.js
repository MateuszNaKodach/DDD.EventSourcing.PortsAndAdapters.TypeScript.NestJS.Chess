parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"MLWx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.columnNumberToCharacter=void 0;const e=require("./square");function r(r){return e.numberToColumn[r]}exports.columnNumberToCharacter=r;
},{"./square":"uP5f"}],"uP5f":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Column=exports.numberToColumn=exports.columnToNumber=exports.Row=exports.Square=exports.SQUARE_ID_SEPARATOR=void 0;const r=require("./helper");exports.SQUARE_ID_SEPARATOR="-";class e{constructor(r,e){this.column=r,this.row=e}static at(a,u){let n,s;return n=o.isValidColumnCharacter(a)?o.fromCharacter(a):o.isValidColumnNumber(a)?o.fromCharacter(r.columnNumberToCharacter(a)):a,s=u instanceof t?u:t.fromNumber(u),new e(n,s)}static fromAlgebraicNotation(r){if(2!==r.length)throw new Error(`${r} is not valid chess algebraic notation square!`);const a=r.charAt(0),u=r.charAt(1);return new e(o.fromCharacter(a),t.fromNumber(parseInt(u)))}static withId(r){const[t,o]=r.split(exports.SQUARE_ID_SEPARATOR);return e.at(t,Number.parseInt(o))}get col(){return this.column}atColumn(r){return new e(r,this.row)}atRow(r){return new e(this.column,r)}atX(e){return this.atColumn(o.fromCharacter(r.columnNumberToCharacter(e)))}atY(r){return this.atRow(t.fromNumber(r))}transform(r){let e=this;if(r.row){const o=this.row.number+r.row;if(!t.isValidRowNumber(o))return;e=e.atY(o)}if(r.col){const t=this.column.number+r.col;if(!o.isValidColumnNumber(t))return;e=e.atX(t)}return e}difference(r){return{col:r.column.number-this.column.number,row:r.row.number-this.row.number}}get id(){return`${this.column.character}${exports.SQUARE_ID_SEPARATOR}${this.row.number}`}get algebraicNotation(){return`${this.column.character}${this.row.number}`}equals(r){return!!r&&this.algebraicNotation===r.algebraicNotation}}exports.Square=e,function(r){r.availableNumber=[1,2,3,4,5,6,7,8],r.lowercaseAvailableColumns=["a","b","c","d","e","f","g","h"],r.uppercaseAvailableColumns=["A","B","C","D","E","F","G","H"]}(e=exports.Square||(exports.Square={}));class t{constructor(r){this.number=r}static fromNumber(r){return new t(r)}static isValidRowNumber(r){return e.availableNumber.includes(Number.parseInt(r))}}exports.Row=t,exports.columnToNumber={A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8},exports.numberToColumn={1:"A",2:"B",3:"C",4:"D",5:"E",6:"F",7:"G",8:"H"};class o{constructor(r){this.character=r}static fromCharacter(r){return new o(r.toUpperCase())}static isValidColumnCharacter(r){return"string"==typeof r&&e.uppercaseAvailableColumns.includes(r.toUpperCase())}static isValidColumnNumber(r){return e.availableNumber.includes(r)}get number(){return exports.columnToNumber[this.character]}}exports.Column=o;
},{"./helper":"MLWx"}],"gIyk":[function(require,module,exports) {
"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.Side=void 0,function(e){e.WHITE="white",e.BLACK="black"}(e=exports.Side||(exports.Side={})),function(e){function t(){return[e.WHITE,e.BLACK]}function o(e){const o=e.toLowerCase();return t().find(e=>o===e.toLowerCase()||e[0]===o.toLowerCase()[0])}e.values=t,e.findByString=o,e.byName=function(e){return o(e)},e.another=function(t){return t===e.WHITE?e.BLACK:e.WHITE}}(e=exports.Side||(exports.Side={}));
},{}],"iO7t":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MoveType=exports.PieceMove=void 0;class e{constructor(e,t){this.type=e,this.square=t}static attackAt(o){return new e(t.ATTACK,o)}static normalAt(o){return new e(t.NORMAL,o)}}var t;exports.PieceMove=e,function(e){e.NORMAL="normal",e.ATTACK="attack"}(t=exports.MoveType||(exports.MoveType={}));
},{}],"xXiL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.canCapturePiece=exports.lineMoves=exports.patternMoves=exports.Piece=void 0;const e=require("./side"),t=require("./piece-move");class r{constructor(e){this.side=e}getAvailableMoves(e,t){return this.getPiecePatternMoves(e,t).filter(this.cannotExposeKingOnAttack(e,t))}getPiecePatternMoves(e,t){return this.getPatternSquares(e,t).map(t=>this.toPieceMove(e)(t))}canMove(e,t){return this.getAvailableMoves(e,t).length>0}getAttackMoves(e,r){return this.getAvailableMoves(e,r).filter(e=>e.type==t.MoveType.ATTACK)}getAttackSquares(e,t){return this.getAttackMoves(e,t).map(e=>e.square)}getNonAttackMoves(e,r){return this.getAvailableMoves(e,r).filter(e=>e.type!==t.MoveType.ATTACK)}canAttackOn(e,t,r){return this.getAttackSquares(e,t).some(e=>e.equals(r))}withinPatternOn(e,t,r){return this.getPatternSquares(e,t).some(e=>e.equals(r))}get name(){return this.constructor.name}isWhite(){return this.side===e.Side.WHITE}isBlack(){return this.side===e.Side.BLACK}isOpponentOf(e){return this.side!==e.side}canAttackOnSquare(e,t){return e.squareIsOccupied(t)&&e.pieceOn(t).isOpponentOf(this)}toPieceMove(e){return r=>this.canAttackOnSquare(e,r)?t.PieceMove.attackAt(r):t.PieceMove.normalAt(r)}equals(e){return void 0!==e&&e.side===this.side&&e.name===this.name}cannotExposeKingOnAttack(e,t){return r=>{const n=r.square,i=e.afterMove(t,n),o=i.squareOfKing(this.side);return!o||!s(this.side,i,o)}}}function s(e,t,r){return t.piecesOnSquares.filter(t=>t.piece.side!==e).some(e=>e.piece.withinPatternOn(t,e.square,r))}function n(e,t,r,[s,...i]){if(!s)return[];const o=r.transform({col:s.column,row:s.row});return!o||a(e,t,o)?n(e,t,r,i):[o,...n(e,t,r,i)]}function i(e,t,r,s){const n=r.transform(s);return n?n&&o(e,t,n)?[n]:n&&a(e,t,n)?[]:[n,...i(e,t,n,s)]:[]}function o(e,t,r){const s=t.pieceOn(r);return void 0!==s&&s.side!==e}function a(e,t,r){const s=t.pieceOn(r);return void 0!==s&&s.side===e}exports.Piece=r,exports.patternMoves=n,exports.lineMoves=i,exports.canCapturePiece=o;
},{"./side":"gIyk","./piece-move":"iO7t"}],"E4N0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Bishop=void 0;const e=require("./piece");class s extends e.Piece{constructor(e){super(e)}getPatternSquares(s,o){return[...e.lineMoves(this.side,s,o,{row:-1,col:-1}),...e.lineMoves(this.side,s,o,{row:-1,col:1}),...e.lineMoves(this.side,s,o,{row:1,col:1}),...e.lineMoves(this.side,s,o,{row:1,col:-1})]}}exports.Bishop=s;
},{"./piece":"xXiL"}],"ZIJY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Rook=void 0;const e=require("./piece");class s extends e.Piece{constructor(e){super(e)}getPatternSquares(s,o){return[...e.lineMoves(this.side,s,o,{row:-1}),...e.lineMoves(this.side,s,o,{row:1}),...e.lineMoves(this.side,s,o,{col:-1}),...e.lineMoves(this.side,s,o,{col:1})]}}exports.Rook=s;
},{"./piece":"xXiL"}],"s9aw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.castlingPattern=exports.King=void 0;const e=require("./piece"),r=require("./side"),t=require("../board"),o=require("./rook");class n extends e.Piece{constructor(e){super(e)}getPatternSquares(r,t){return e.patternMoves(this.side,r,t,n.MOVES_PATTERN)}getAvailableMoves(e,r){return this.getPatternSquares(e,r).map(r=>this.toPieceMove(e)(r)).filter(this.cannotExposeKingOnAttack(e,r)).concat(i(this.side,e,r).map(r=>this.toPieceMove(e)(r)))}isInCheck(e,r){return p(this.side,e,r)}isCheckmate(e,r){return this.isInCheck(e,r)&&!e.canMoveOn(this.side)}}function i(e,r,t){const o=[];return f(e,r)?[]:(u(e,r)&&a(t,r)&&!c(t,r)&&o.push(t.transform({col:-2})),m(e,r)&&l(t,r)&&!s(t,r)&&o.push(t.transform({col:2})),o)}function c(e,r){return[{col:0},{col:-1},{col:-2}].map(r=>e.transform(r)).some(t=>t&&r.afterMove(e,t).isKingChecked())}function s(e,r){return[{col:0},{col:1},{col:2}].map(r=>e.transform(r)).some(t=>t&&r.afterMove(e,t).isKingChecked())}function u(e,t){return t.squaresWith(new o.Rook(e)).find(t=>t.algebraicNotation===(e===r.Side.WHITE?"A1":"A8"))}function a(e,r){return[{col:-1},{col:-2},{col:-3}].map(r=>e.transform(r)).every(e=>e&&!r.squareIsOccupied(e))}function l(e,r){return[{col:1},{col:2}].map(r=>e.transform(r)).every(e=>e&&!r.squareIsOccupied(e))}function m(e,t){return t.squaresWith(new o.Rook(e)).find(t=>t.algebraicNotation===(e===r.Side.WHITE?"H1":"H8"))}function f(e,o){const n=o.squareOfKing(e),i=t.Square.fromAlgebraicNotation(e===r.Side.WHITE?"E1":"E8");return!n||!n.equals(i)}function p(e,r,t){return r.piecesOnSquares.filter(r=>r.piece.side!==e).filter(e=>"King"!==e.piece.name).some(e=>e.piece.canAttackOn(r,e.square,t))}exports.King=n,n.MOVES_PATTERN=[{column:-1,row:-1},{column:-1,row:0},{column:-1,row:1},{column:0,row:1},{column:1,row:1},{column:1,row:0},{column:1,row:-1},{column:0,row:-1}],exports.castlingPattern=i;
},{"./piece":"xXiL","./side":"gIyk","../board":"c6VJ","./rook":"ZIJY"}],"tbyu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Knight=void 0;const e=require("./piece");class o extends e.Piece{constructor(e){super(e)}getPatternSquares(r,t){return e.patternMoves(this.side,r,t,o.MOVES_PATTERN)}}exports.Knight=o,o.MOVES_PATTERN=[{column:2,row:1},{column:1,row:2},{column:1,row:-2},{column:2,row:-1},{column:-2,row:1},{column:-1,row:2},{column:-1,row:-2},{column:-2,row:-1}];
},{"./piece":"xXiL"}],"Du3u":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Pawn=void 0;const e=require("./piece"),r=require("./side"),t=require("../board"),n=require("./piece-move");class o extends e.Piece{constructor(e){super(e)}getPatternSquares(e,r){return i(this.side,e,r)}getPiecePatternMoves(e,r){const t=super.getPiecePatternMoves(e,r),o=m(this.side,r,e).map(e=>n.PieceMove.attackAt(e));return t.concat(o)}isOnTheOppositeEdgeOfTheBoard(e){return e.row.number===(this.isWhite()?8:1)}static isPawn(e){return"Pawn"===e.name}}function i(e,t,n){const o=e===r.Side.WHITE?1:-1,i=[{column:1,row:o},{column:-1,row:o}];return[...c(t,n,a(e,n)?[{column:0,row:o},{column:0,row:2*o}]:[{column:0,row:o}]),...u(e,n,t,i)]}function u(r,t,n,[o,...i]){if(!o)return[];const c=t.transform({col:o.column,row:o.row});return c&&e.canCapturePiece(r,n,c)?[c,...u(r,t,n,i)]:u(r,t,n,i)}function c(e,r,[t,...n]){if(!t)return[];const o=r.transform({col:t.column,row:t.row});return!o||s(e,o)?[]:[o,...c(e,r,n)]}function s(e,r){return void 0!==e.pieceOn(r)}function a(e,t){return e===r.Side.WHITE?2===t.row.number:e===r.Side.BLACK&&7===t.row.number}function m(e,r,n){const o=n.lastMove;if(!o)return[];if(!("Pawn"===o.piece.name&&o.piece.side!==e&&2==Math.abs(o.from.row.number-o.to.row.number)&&1==Math.abs(r.column.number-o.to.column.number)&&0==Math.abs(r.row.number-o.to.row.number)))return[];const i=t.Square.fromAlgebraicNotation(o.to.algebraicNotation).transform({row:o.piece.isWhite()?-1:1});return i?[i]:[]}exports.Pawn=o;
},{"./piece":"xXiL","./side":"gIyk","../board":"c6VJ","./piece-move":"iO7t"}],"UGke":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isPieceName=exports.isPromotionPieceName=void 0;const e=["King","Queen","Bishop","Knight","Rook","Pawn"],o=["Queen","Bishop","Knight","Rook"];function i(e){return void 0!==e&&o.map(e=>e.toLowerCase()).includes(e.toLowerCase())}function t(o){return void 0!==o&&e.map(e=>e.toLowerCase()).includes(o.toLowerCase())}exports.isPromotionPieceName=i,exports.isPieceName=t;
},{}],"XGOD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Queen=void 0;const e=require("./piece");class s extends e.Piece{constructor(e){super(e)}getPatternSquares(s,i){return[...e.lineMoves(this.side,s,i,{row:-1}),...e.lineMoves(this.side,s,i,{row:1}),...e.lineMoves(this.side,s,i,{col:-1}),...e.lineMoves(this.side,s,i,{col:1}),...e.lineMoves(this.side,s,i,{row:-1,col:-1}),...e.lineMoves(this.side,s,i,{row:-1,col:1}),...e.lineMoves(this.side,s,i,{row:1,col:1}),...e.lineMoves(this.side,s,i,{row:1,col:-1})]}}exports.Queen=s;
},{"./piece":"xXiL"}],"wCjP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Pieces=void 0;const e=require("./king"),i=require("./queen"),n=require("./bishop"),r=require("./knight"),o=require("./rook"),s=require("./pawn"),t={King:i=>new e.King(i),Queen:e=>new i.Queen(e),Bishop:e=>new n.Bishop(e),Knight:e=>new r.Knight(e),Rook:e=>new o.Rook(e),Pawn:e=>new s.Pawn(e)};class u{static getBy(e,i){return t[e](i)}}exports.Pieces=u;
},{"./king":"s9aw","./queen":"XGOD","./bishop":"E4N0","./knight":"tbyu","./rook":"ZIJY","./pawn":"Du3u"}],"lCXp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});
},{}],"O6AC":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,r,t,i){void 0===i&&(i=t),Object.defineProperty(e,i,{enumerable:!0,get:function(){return r[t]}})}:function(e,r,t,i){void 0===i&&(i=t),e[i]=r[t]}),r=this&&this.__exportStar||function(r,t){for(var i in r)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||e(t,r,i)};Object.defineProperty(exports,"__esModule",{value:!0}),r(require("./bishop"),exports),r(require("./king"),exports),r(require("./knight"),exports),r(require("./pawn"),exports),r(require("./piece"),exports),r(require("./piece-move"),exports),r(require("./piece-name"),exports),r(require("./pieces"),exports),r(require("./promotion-piece"),exports),r(require("./queen"),exports),r(require("./rook"),exports),r(require("./side"),exports);
},{"./bishop":"E4N0","./king":"s9aw","./knight":"tbyu","./pawn":"Du3u","./piece":"xXiL","./piece-move":"iO7t","./piece-name":"UGke","./pieces":"wCjP","./promotion-piece":"lCXp","./queen":"XGOD","./rook":"ZIJY","./side":"gIyk"}],"iT7q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AggregateVersion=void 0;class e{constructor(e){this.raw=e,this.TYPE="AggregateVersion"}static of(r){if(r<0||!e.isInteger(r))throw new Error("Aggregate version number must be integer >= 0!");return new e(r)}static new(){return new e(0)}increase(){return new e(this.raw+1)}static isInteger(e){return e%1==0}}exports.AggregateVersion=e;
},{}],"QRcQ":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),t=this&&this.__exportStar||function(t,r){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(r,i)||e(r,t,i)};Object.defineProperty(exports,"__esModule",{value:!0}),t(require("./aggregate-id.valueobject"),exports),t(require("./aggregate-version.valueobject"),exports);
},{"./aggregate-id.valueobject":"lCXp","./aggregate-version.valueobject":"iT7q"}],"dFY8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractDomainEvent=void 0;class t{constructor(t,e,a,s,r){this.eventId=t,this.occurredAt=e,this.aggregateId=a,this.data=s,this.metadata=r}get eventType(){return Object.getPrototypeOf(this).constructor.name}enhance(t){return Object.assign(Object.assign({},this),{metadata:Object.assign(Object.assign({},this.metadata),{metadata:t})})}}exports.AbstractDomainEvent=t;
},{}],"cqHH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractFailureDomainEvent=void 0;const e=require("./abstract-domain-event");class t extends e.AbstractDomainEvent{}exports.AbstractFailureDomainEvent=t;
},{"./abstract-domain-event":"dFY8"}],"BftK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractSuccessDomainEvent=void 0;const e=require("./abstract-domain-event");class t extends e.AbstractDomainEvent{}exports.AbstractSuccessDomainEvent=t;
},{"./abstract-domain-event":"dFY8"}],"NiBi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=o;var e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),t=new Uint8Array(16);function o(){if(!e)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return e(t)}
},{}],"g0si":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;exports.default=e;
},{}],"dx62":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("./regex.js"));function t(e){return e&&e.__esModule?e:{default:e}}function r(t){return"string"==typeof t&&e.default.test(t)}var u=r;exports.default=u;
},{"./regex.js":"g0si"}],"iVWR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("./validate.js"));function r(e){return e&&e.__esModule?e:{default:e}}for(var t=[],i=0;i<256;++i)t.push((i+256).toString(16).substr(1));function o(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=(t[r[i+0]]+t[r[i+1]]+t[r[i+2]]+t[r[i+3]]+"-"+t[r[i+4]]+t[r[i+5]]+"-"+t[r[i+6]]+t[r[i+7]]+"-"+t[r[i+8]]+t[r[i+9]]+"-"+t[r[i+10]]+t[r[i+11]]+t[r[i+12]]+t[r[i+13]]+t[r[i+14]]+t[r[i+15]]).toLowerCase();if(!(0,e.default)(o))throw TypeError("Stringified UUID is invalid");return o}var u=o;exports.default=u;
},{"./validate.js":"dx62"}],"B4zH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e,r,s=o(require("./rng.js")),n=o(require("./stringify.js"));function o(e){return e&&e.__esModule?e:{default:e}}var u=0,t=0;function a(o,a,l){var d=a&&l||0,i=a||new Array(16),c=(o=o||{}).node||e,v=void 0!==o.clockseq?o.clockseq:r;if(null==c||null==v){var f=o.random||(o.rng||s.default)();null==c&&(c=e=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==v&&(v=r=16383&(f[6]<<8|f[7]))}var q=void 0!==o.msecs?o.msecs:Date.now(),m=void 0!==o.nsecs?o.nsecs:t+1,p=q-u+(m-t)/1e4;if(p<0&&void 0===o.clockseq&&(v=v+1&16383),(p<0||q>u)&&void 0===o.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=q,t=m,r=v;var w=(1e4*(268435455&(q+=122192928e5))+m)%4294967296;i[d++]=w>>>24&255,i[d++]=w>>>16&255,i[d++]=w>>>8&255,i[d++]=255&w;var _=q/4294967296*1e4&268435455;i[d++]=_>>>8&255,i[d++]=255&_,i[d++]=_>>>24&15|16,i[d++]=_>>>16&255,i[d++]=v>>>8|128,i[d++]=255&v;for(var g=0;g<6;++g)i[d+g]=c[g];return a||(0,n.default)(i)}var l=a;exports.default=l;
},{"./rng.js":"NiBi","./stringify.js":"iVWR"}],"dgIt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("./validate.js"));function r(e){return e&&e.__esModule?e:{default:e}}function t(r){if(!(0,e.default)(r))throw TypeError("Invalid UUID");var t,s=new Uint8Array(16);return s[0]=(t=parseInt(r.slice(0,8),16))>>>24,s[1]=t>>>16&255,s[2]=t>>>8&255,s[3]=255&t,s[4]=(t=parseInt(r.slice(9,13),16))>>>8,s[5]=255&t,s[6]=(t=parseInt(r.slice(14,18),16))>>>8,s[7]=255&t,s[8]=(t=parseInt(r.slice(19,23),16))>>>8,s[9]=255&t,s[10]=(t=parseInt(r.slice(24,36),16))/1099511627776&255,s[11]=t/4294967296&255,s[12]=t>>>24&255,s[13]=t>>>16&255,s[14]=t>>>8&255,s[15]=255&t,s}var s=t;exports.default=s;
},{"./validate.js":"dx62"}],"E1mr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=s,exports.URL=exports.DNS=void 0;var e=t(require("./stringify.js")),r=t(require("./parse.js"));function t(e){return e&&e.__esModule?e:{default:e}}function n(e){e=unescape(encodeURIComponent(e));for(var r=[],t=0;t<e.length;++t)r.push(e.charCodeAt(t));return r}var a="6ba7b810-9dad-11d1-80b4-00c04fd430c8";exports.DNS=a;var o="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function s(t,s,u){function i(t,a,o,i){if("string"==typeof t&&(t=n(t)),"string"==typeof a&&(a=(0,r.default)(a)),16!==a.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var d=new Uint8Array(16+t.length);if(d.set(a),d.set(t,a.length),(d=u(d))[6]=15&d[6]|s,d[8]=63&d[8]|128,o){i=i||0;for(var f=0;f<16;++f)o[i+f]=d[f];return o}return(0,e.default)(d)}try{i.name=t}catch(d){}return i.DNS=a,i.URL=o,i}exports.URL=o;
},{"./stringify.js":"iVWR","./parse.js":"dgIt"}],"z47x":[function(require,module,exports) {
"use strict";function n(n){if("string"==typeof n){var t=unescape(encodeURIComponent(n));n=new Uint8Array(t.length);for(var o=0;o<t.length;++o)n[o]=t.charCodeAt(o)}return r(e(u(n),8*n.length))}function r(n){for(var r=[],t=32*n.length,e=0;e<t;e+=8){var u=n[e>>5]>>>e%32&255,o=parseInt("0123456789abcdef".charAt(u>>>4&15)+"0123456789abcdef".charAt(15&u),16);r.push(o)}return r}function t(n){return 14+(n+64>>>9<<4)+1}function e(n,r){n[r>>5]|=128<<r%32,n[t(r)-1]=r;for(var e=1732584193,u=-271733879,f=-1732584194,a=271733878,v=0;v<n.length;v+=16){var s=e,d=u,p=f,g=a;e=c(e,u,f,a,n[v],7,-680876936),a=c(a,e,u,f,n[v+1],12,-389564586),f=c(f,a,e,u,n[v+2],17,606105819),u=c(u,f,a,e,n[v+3],22,-1044525330),e=c(e,u,f,a,n[v+4],7,-176418897),a=c(a,e,u,f,n[v+5],12,1200080426),f=c(f,a,e,u,n[v+6],17,-1473231341),u=c(u,f,a,e,n[v+7],22,-45705983),e=c(e,u,f,a,n[v+8],7,1770035416),a=c(a,e,u,f,n[v+9],12,-1958414417),f=c(f,a,e,u,n[v+10],17,-42063),u=c(u,f,a,e,n[v+11],22,-1990404162),e=c(e,u,f,a,n[v+12],7,1804603682),a=c(a,e,u,f,n[v+13],12,-40341101),f=c(f,a,e,u,n[v+14],17,-1502002290),e=i(e,u=c(u,f,a,e,n[v+15],22,1236535329),f,a,n[v+1],5,-165796510),a=i(a,e,u,f,n[v+6],9,-1069501632),f=i(f,a,e,u,n[v+11],14,643717713),u=i(u,f,a,e,n[v],20,-373897302),e=i(e,u,f,a,n[v+5],5,-701558691),a=i(a,e,u,f,n[v+10],9,38016083),f=i(f,a,e,u,n[v+15],14,-660478335),u=i(u,f,a,e,n[v+4],20,-405537848),e=i(e,u,f,a,n[v+9],5,568446438),a=i(a,e,u,f,n[v+14],9,-1019803690),f=i(f,a,e,u,n[v+3],14,-187363961),u=i(u,f,a,e,n[v+8],20,1163531501),e=i(e,u,f,a,n[v+13],5,-1444681467),a=i(a,e,u,f,n[v+2],9,-51403784),f=i(f,a,e,u,n[v+7],14,1735328473),e=h(e,u=i(u,f,a,e,n[v+12],20,-1926607734),f,a,n[v+5],4,-378558),a=h(a,e,u,f,n[v+8],11,-2022574463),f=h(f,a,e,u,n[v+11],16,1839030562),u=h(u,f,a,e,n[v+14],23,-35309556),e=h(e,u,f,a,n[v+1],4,-1530992060),a=h(a,e,u,f,n[v+4],11,1272893353),f=h(f,a,e,u,n[v+7],16,-155497632),u=h(u,f,a,e,n[v+10],23,-1094730640),e=h(e,u,f,a,n[v+13],4,681279174),a=h(a,e,u,f,n[v],11,-358537222),f=h(f,a,e,u,n[v+3],16,-722521979),u=h(u,f,a,e,n[v+6],23,76029189),e=h(e,u,f,a,n[v+9],4,-640364487),a=h(a,e,u,f,n[v+12],11,-421815835),f=h(f,a,e,u,n[v+15],16,530742520),e=l(e,u=h(u,f,a,e,n[v+2],23,-995338651),f,a,n[v],6,-198630844),a=l(a,e,u,f,n[v+7],10,1126891415),f=l(f,a,e,u,n[v+14],15,-1416354905),u=l(u,f,a,e,n[v+5],21,-57434055),e=l(e,u,f,a,n[v+12],6,1700485571),a=l(a,e,u,f,n[v+3],10,-1894986606),f=l(f,a,e,u,n[v+10],15,-1051523),u=l(u,f,a,e,n[v+1],21,-2054922799),e=l(e,u,f,a,n[v+8],6,1873313359),a=l(a,e,u,f,n[v+15],10,-30611744),f=l(f,a,e,u,n[v+6],15,-1560198380),u=l(u,f,a,e,n[v+13],21,1309151649),e=l(e,u,f,a,n[v+4],6,-145523070),a=l(a,e,u,f,n[v+11],10,-1120210379),f=l(f,a,e,u,n[v+2],15,718787259),u=l(u,f,a,e,n[v+9],21,-343485551),e=o(e,s),u=o(u,d),f=o(f,p),a=o(a,g)}return[e,u,f,a]}function u(n){if(0===n.length)return[];for(var r=8*n.length,e=new Uint32Array(t(r)),u=0;u<r;u+=8)e[u>>5]|=(255&n[u/8])<<u%32;return e}function o(n,r){var t=(65535&n)+(65535&r);return(n>>16)+(r>>16)+(t>>16)<<16|65535&t}function f(n,r){return n<<r|n>>>32-r}function a(n,r,t,e,u,a){return o(f(o(o(r,n),o(e,a)),u),t)}function c(n,r,t,e,u,o,f){return a(r&t|~r&e,n,r,u,o,f)}function i(n,r,t,e,u,o,f){return a(r&e|t&~e,n,r,u,o,f)}function h(n,r,t,e,u,o,f){return a(r^t^e,n,r,u,o,f)}function l(n,r,t,e,u,o,f){return a(t^(r|~e),n,r,u,o,f)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var v=n;exports.default=v;
},{}],"TS3W":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("./v35.js")),r=t(require("./md5.js"));function t(e){return e&&e.__esModule?e:{default:e}}var u=(0,e.default)("v3",48,r.default),d=u;exports.default=d;
},{"./v35.js":"E1mr","./md5.js":"z47x"}],"VS79":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("./rng.js")),r=t(require("./stringify.js"));function t(e){return e&&e.__esModule?e:{default:e}}function u(t,u,n){var a=(t=t||{}).random||(t.rng||e.default)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,u){n=n||0;for(var f=0;f<16;++f)u[n+f]=a[f];return u}return(0,r.default)(a)}var n=u;exports.default=n;
},{"./rng.js":"NiBi","./stringify.js":"iVWR"}],"UaB7":[function(require,module,exports) {
"use strict";function r(r,e,t,a){switch(r){case 0:return e&t^~e&a;case 1:return e^t^a;case 2:return e&t^e&a^t&a;case 3:return e^t^a}}function e(r,e){return r<<e|r>>>32-e}function t(t){var a=[1518500249,1859775393,2400959708,3395469782],o=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){var n=unescape(encodeURIComponent(t));t=[];for(var s=0;s<n.length;++s)t.push(n.charCodeAt(s))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var f=t.length/4+2,u=Math.ceil(f/16),c=new Array(u),l=0;l<u;++l){for(var i=new Uint32Array(16),v=0;v<16;++v)i[v]=t[64*l+4*v]<<24|t[64*l+4*v+1]<<16|t[64*l+4*v+2]<<8|t[64*l+4*v+3];c[l]=i}c[u-1][14]=8*(t.length-1)/Math.pow(2,32),c[u-1][14]=Math.floor(c[u-1][14]),c[u-1][15]=8*(t.length-1)&4294967295;for(var h=0;h<u;++h){for(var p=new Uint32Array(80),y=0;y<16;++y)p[y]=c[h][y];for(var d=16;d<80;++d)p[d]=e(p[d-3]^p[d-8]^p[d-14]^p[d-16],1);for(var A=o[0],g=o[1],w=o[2],M=o[3],x=o[4],U=0;U<80;++U){var C=Math.floor(U/20),_=e(A,5)+r(C,g,w,M)+x+a[C]+p[U]>>>0;x=M,M=w,w=e(g,30)>>>0,g=A,A=_}o[0]=o[0]+A>>>0,o[1]=o[1]+g>>>0,o[2]=o[2]+w>>>0,o[3]=o[3]+M>>>0,o[4]=o[4]+x>>>0}return[o[0]>>24&255,o[0]>>16&255,o[0]>>8&255,255&o[0],o[1]>>24&255,o[1]>>16&255,o[1]>>8&255,255&o[1],o[2]>>24&255,o[2]>>16&255,o[2]>>8&255,255&o[2],o[3]>>24&255,o[3]>>16&255,o[3]>>8&255,255&o[3],o[4]>>24&255,o[4]>>16&255,o[4]>>8&255,255&o[4]]}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var a=t;exports.default=a;
},{}],"LTsz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("./v35.js")),r=t(require("./sha1.js"));function t(e){return e&&e.__esModule?e:{default:e}}var u=(0,e.default)("v5",80,r.default),s=u;exports.default=s;
},{"./v35.js":"E1mr","./sha1.js":"UaB7"}],"bKUh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e="00000000-0000-0000-0000-000000000000";exports.default=e;
},{}],"uQak":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("./validate.js"));function r(e){return e&&e.__esModule?e:{default:e}}function t(r){if(!(0,e.default)(r))throw TypeError("Invalid UUID");return parseInt(r.substr(14,1),16)}var u=t;exports.default=u;
},{"./validate.js":"dx62"}],"us6L":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"v1",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(exports,"v3",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(exports,"v4",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(exports,"v5",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(exports,"NIL",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(exports,"version",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(exports,"validate",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(exports,"stringify",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(exports,"parse",{enumerable:!0,get:function(){return s.default}});var e=a(require("./v1.js")),r=a(require("./v3.js")),t=a(require("./v4.js")),n=a(require("./v5.js")),u=a(require("./nil.js")),i=a(require("./version.js")),o=a(require("./validate.js")),f=a(require("./stringify.js")),s=a(require("./parse.js"));function a(e){return e&&e.__esModule?e:{default:e}}
},{"./v1.js":"B4zH","./v3.js":"TS3W","./v4.js":"VS79","./v5.js":"LTsz","./nil.js":"bKUh","./version.js":"uQak","./validate.js":"dx62","./stringify.js":"iVWR","./parse.js":"dgIt"}],"nCyA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CorrelationId=void 0;const r=require("uuid");class t{constructor(r){this.raw=r,this.TYPE="CorrelationId"}static of(r){return new t(r)}static generate(){return new t(r.v4())}toString(){return this.raw}equals(r){return void 0!==r&&this.raw===r.raw}}exports.CorrelationId=t;
},{"uuid":"us6L"}],"auyL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CausationId=void 0;const t=require("uuid"),r=require("./correlation-id.valueobject");class e{constructor(t){this.raw=t,this.TYPE="CausationId"}static of(t){return new e(t)}toCorrelation(){return r.CorrelationId.of(this.raw)}static fromEventId(t){return e.of(t.raw)}static generate(){return new e(t.v4())}toString(){return this.raw}}exports.CausationId=e;
},{"uuid":"us6L","./correlation-id.valueobject":"nCyA"}],"NrgR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DomainEventId=void 0;const e=require("uuid");class t{constructor(e){this.raw=e,this.TYPE="DomainEventId"}static generate(){return new t(e.v4())}static of(e){return new t(e)}}exports.DomainEventId=t;
},{"uuid":"us6L"}],"SD13":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DomainEvents=void 0;class t{constructor(t){this._events=t}static clean(){return new t([])}append(e){return new t([...this.toArray(),e])}forgetLast(e=!0){let r=this.toArray();const s=r.pop();return s&&e&&(r=r.filter(t=>t.metadata.correlationId.equals(s.metadata.correlationId))),new t(r)}toArray(){return[...this._events]}}exports.DomainEvents=t;
},{}],"mwh9":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),t=this&&this.__exportStar||function(t,r){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(r,i)||e(r,t,i)};Object.defineProperty(exports,"__esModule",{value:!0}),t(require("./abstract-domain-event"),exports),t(require("./abstract-failure-domain-event"),exports),t(require("./abstract-success-domain-event"),exports),t(require("./causation-id.valueobject"),exports),t(require("./correlation-id.valueobject"),exports),t(require("./domain-event"),exports),t(require("./domain-event-id.valueobject"),exports),t(require("./domain-events"),exports);
},{"./abstract-domain-event":"dFY8","./abstract-failure-domain-event":"cqHH","./abstract-success-domain-event":"BftK","./causation-id.valueobject":"auyL","./correlation-id.valueobject":"nCyA","./domain-event":"lCXp","./domain-event-id.valueobject":"NrgR","./domain-events":"SD13"}],"qv4a":[function(require,module,exports) {
"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractMutableAggregateRoot=void 0;const t=require("../aggregate"),r=require("../event"),n=Symbol();class i{constructor(r){this[e]=[],this._committedVersion=t.AggregateVersion.new(),this._currentVersion=t.AggregateVersion.new(),this.timeProvider=r}get currentDate(){return this.timeProvider.currentDate()}getUncommittedEvents(){return this[n]}clearUncommittedEvents(){this[n].length=0}loadFromHistory(e){e.forEach(e=>this.apply(e,!0))}applyAll(e,t=!1){e.forEach(e=>this.apply(e,t))}executeCommand(e){const t=e();return this.applyAll(t.events),t}apply(e,t=!1){t||this[n].push(e),this._currentVersion=this._currentVersion.increase(),t&&(this._committedVersion=this._committedVersion.increase());const i=this.getEventHandler(e);if(!(i||e instanceof r.AbstractFailureDomainEvent))throw new Error(`Handler for domain event ${e.eventType} not found!`);i&&i.call(this,e)}getEventHandler(e){return this[`on${this.getEventName(e)}`]}getEventName(e){const{constructor:t}=Object.getPrototypeOf(e);return t.name}get aggregateId(){return this.id}get committedVersion(){return this._committedVersion}get currentVersion(){return this._currentVersion}}exports.AbstractMutableAggregateRoot=i,e=n;
},{"../aggregate":"QRcQ","../event":"mwh9"}],"iUpO":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),t=this&&this.__exportStar||function(t,r){for(var o in t)"default"===o||Object.prototype.hasOwnProperty.call(r,o)||e(r,t,o)};Object.defineProperty(exports,"__esModule",{value:!0}),t(require("./abstract-mutable-aggregate-root"),exports),t(require("./aggregate-root.repository"),exports);
},{"./abstract-mutable-aggregate-root":"qv4a","./aggregate-root.repository":"lCXp"}],"RxhZ":[function(require,module,exports) {
"use strict";function e(e){return null!=e}function t(t){return!e(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isNotDefined=exports.isDefined=void 0,exports.isDefined=e,exports.isNotDefined=t;
},{}],"znyQ":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),t=this&&this.__exportStar||function(t,r){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(r,i)||e(r,t,i)};Object.defineProperty(exports,"__esModule",{value:!0}),t(require("./defined"),exports);
},{"./defined":"RxhZ"}],"YIbh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Failure=exports.Success=exports.Result=void 0;class e{static success(e){return void 0===e?s.empty():Array.isArray(e)?s.many(e):s.single(e)}static failure(e){return new t(e)}isSuccess(){return void 0===this.failureReason()}isFailure(){return!this.isSuccess()}handleEvents(e){this.events.map(e=>e).forEach(e)}}exports.Result=e;class s extends e{constructor(e){super(),this._events=e}static empty(){return new s([])}get events(){return[...this._events]}static many(e){return new s([...e])}static single(e){return new s([e])}failureReason(){}also(e){if(!e.isSuccess())throw new Error("Cannot concat result which is success and failure at the same time!");return new s([...this.events,...e.events])}}exports.Success=s;class t extends e{constructor(e){super(),this.reason=e}failureReason(){return this.reason.data.reason}get events(){return[this.reason]}}exports.Failure=t;
},{}],"eFMJ":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),t=this&&this.__exportStar||function(t,r){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(r,i)||e(r,t,i)};Object.defineProperty(exports,"__esModule",{value:!0}),t(require("./result"),exports),t(require("./failure-reason"),exports);
},{"./result":"YIbh","./failure-reason":"lCXp"}],"eJ3f":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isDomainEvent=exports.expectDomainEvent=void 0;const e=require("../aggregate-mutable"),t=require("../event");function n(t,n){const a=t instanceof e.AbstractMutableAggregateRoot?t.getUncommittedEvents().filter(e=>o(e)):t.events,i=a.find(e=>e instanceof n.type);if(!o(i))throw new Error(`Expected domain event was not published! Domain events: ${a}`);expect(i).toBeInstanceOf(n.type),n.data&&expect(i.data).toEqual(n.data)}function o(e){return void 0!==e&&e instanceof t.AbstractDomainEvent}exports.expectDomainEvent=n,exports.isDomainEvent=o;
},{"../aggregate-mutable":"iUpO","../event":"mwh9"}],"pxjG":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),t=this&&this.__exportStar||function(t,r){for(var o in t)"default"===o||Object.prototype.hasOwnProperty.call(r,o)||e(r,t,o)};Object.defineProperty(exports,"__esModule",{value:!0}),t(require("./aggregate-root.test-assertions"),exports);
},{"./aggregate-root.test-assertions":"eJ3f"}],"AMVU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TimeProvider=void 0;class e{}exports.TimeProvider=e;
},{}],"YiyQ":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),t=this&&this.__exportStar||function(t,r){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(r,i)||e(r,t,i)};Object.defineProperty(exports,"__esModule",{value:!0}),t(require("./time-provider"),exports);
},{"./time-provider":"AMVU"}],"snZV":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,r,t,i){void 0===i&&(i=t),Object.defineProperty(e,i,{enumerable:!0,get:function(){return r[t]}})}:function(e,r,t,i){void 0===i&&(i=t),e[i]=r[t]}),r=this&&this.__exportStar||function(r,t){for(var i in r)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||e(t,r,i)};Object.defineProperty(exports,"__esModule",{value:!0}),r(require("./aggregate"),exports),r(require("./aggregate-mutable"),exports),r(require("./event"),exports),r(require("./extensions"),exports),r(require("./result"),exports),r(require("./test"),exports),r(require("./time"),exports);
},{"./aggregate":"QRcQ","./aggregate-mutable":"iUpO","./event":"mwh9","./extensions":"znyQ","./result":"eFMJ","./test":"pxjG","./time":"YiyQ"}],"CFwr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ChessBoard=void 0;const e=require("./square"),i=require("../pieces"),n=require("@ddd-es-ts-chess/ddd-building-blocks-domain"),t=8;class o{constructor(e={},i){this.pieces=e,this.lastMove=i,this.movePieceHandler=new c(new a(new s))}static empty(){return new o({})}static starting(){return new o({A1:new i.Rook(i.Side.WHITE),B1:new i.Knight(i.Side.WHITE),C1:new i.Bishop(i.Side.WHITE),D1:new i.Queen(i.Side.WHITE),E1:new i.King(i.Side.WHITE),F1:new i.Bishop(i.Side.WHITE),G1:new i.Knight(i.Side.WHITE),H1:new i.Rook(i.Side.WHITE),A2:new i.Pawn(i.Side.WHITE),B2:new i.Pawn(i.Side.WHITE),C2:new i.Pawn(i.Side.WHITE),D2:new i.Pawn(i.Side.WHITE),E2:new i.Pawn(i.Side.WHITE),F2:new i.Pawn(i.Side.WHITE),G2:new i.Pawn(i.Side.WHITE),H2:new i.Pawn(i.Side.WHITE),A8:new i.Rook(i.Side.BLACK),B8:new i.Knight(i.Side.BLACK),C8:new i.Bishop(i.Side.BLACK),D8:new i.Queen(i.Side.BLACK),E8:new i.King(i.Side.BLACK),F8:new i.Bishop(i.Side.BLACK),G8:new i.Knight(i.Side.BLACK),H8:new i.Rook(i.Side.BLACK),A7:new i.Pawn(i.Side.BLACK),B7:new i.Pawn(i.Side.BLACK),C7:new i.Pawn(i.Side.BLACK),D7:new i.Pawn(i.Side.BLACK),E7:new i.Pawn(i.Side.BLACK),F7:new i.Pawn(i.Side.BLACK),G7:new i.Pawn(i.Side.BLACK),H7:new i.Pawn(i.Side.BLACK)})}static withPieces(e){return new o(e)}withMovedPiece(e,i,n){const t=this.movePieceHandler.handle(this,{piece:e,from:i,to:n}),o=t.moves[t.moves.length-1];return Object.assign(Object.assign({},t),{board:t.board.withLastMove({from:o.from,to:o.to,piece:o.piece})})}afterMove(e,i){const n=this.pieceOn(e);return this.cloneBoard().withoutPieceOn(e).withPieceOn(i,n).withLastMove({from:e,to:i,piece:n})}withPieceOn(e,i){const n=this.cloneBoard();return delete n.pieces[e.algebraicNotation],i&&(n.pieces[e.algebraicNotation]=i),n}withoutPieceOn(e){const i=this.cloneBoard();return delete i.pieces[e.algebraicNotation],i}withLastMove(e){return this.cloneBoard(e)}pieceOn(e){return this.pieces[e.algebraicNotation]}squareOfKing(e){const n=this.squaresWith(new i.King(e));return 1==n.length?n[0]:void 0}squaresWith(e){return this.piecesOnSquares.filter(n=>e instanceof i.Piece?n.piece.equals(e):n.piece.name===e).map(e=>e.square)}squareIsOccupied(e){return void 0!==this.pieceOn(e)}get piecesOnSquares(){return Object.entries(this.pieces).map(([i,n])=>({piece:n,square:e.Square.fromAlgebraicNotation(i)})).sort((e,i)=>e.square.algebraicNotation.localeCompare(i.square.algebraicNotation))}isStalemateFor(e){return!this.isKingChecked(e)&&!this.canMoveOn(e)}canMoveOn(e){return this.piecesOnSquares.filter(i=>i.piece.side===e).some(e=>e.piece.canMove(this,e.square))}isKingChecked(e){const i=this.checkedKing();return void 0!==i&&(n.isNotDefined(e)||i.piece.side===e)}checkedKing(){const e=this.piecesOnSquares.find(e=>d(e.piece)&&e.piece.isInCheck(this,e.square));return n.isNotDefined(e)?void 0:{piece:e.piece,square:e.square}}cloneBoard(e){return new o(Object.assign({},this.pieces),e||this.lastMove)}get height(){return t}get width(){return t}}exports.ChessBoard=o;class r{constructor(e){this.next=e}handle(e,i){let n=this.handler(e,i);if(this.next){const e=this.next.handle(n.board,i);n={board:e.board,moves:[...n.moves,...e.moves]}}return n}}class s extends r{constructor(e){super(e)}handler(e,i){const n=e.pieceOn(i.to);return{board:e.withoutPieceOn(i.from).withPieceOn(i.to,i.piece),moves:[{piece:i.piece,from:i.from,to:i.to,captured:n?{piece:n,onSquare:i.to}:void 0}]}}}class c extends r{constructor(e){super(e)}handler(e,i){const n=d(i.piece)&&this.castlingRook(e,i.from,i.to);return n?{board:e.withoutPieceOn(n.from).withPieceOn(n.to,n.rook),moves:[{piece:n.rook,from:n.from,to:n.to}]}:{board:e,moves:[]}}castlingRook(e,i,t){const o=i.difference(t);if(!(n.isDefined(o.col)&&2==o.col||-2==o.col))return;const r=2==o.col,s=i.transform({col:r?3:-4}),c=s.transform({col:r?-2:3}),a=e.pieceOn(s);return h(a)?{rook:a,from:s,to:c}:void 0}}class a extends r{constructor(e){super(e)}handle(e,i){let n=this.handler(e,i);if(this.next&&0===n.moves.length){const e=this.next.handle(n.board,i);n={board:e.board,moves:[...n.moves,...e.moves]}}return n}handler(e,i){var n;const t=i.to.transform({row:i.piece.isWhite()?-1:1});if(!t)return{board:e,moves:[]};const o=e.pieceOn(t);return t&&o&&o.equals(null===(n=e.lastMove)||void 0===n?void 0:n.piece)&&"Pawn"===i.piece.name&&i.from.column.character!==i.to.column.character&&"Pawn"===o.name&&o.isOpponentOf(i.piece)?{board:e.withoutPieceOn(t).withoutPieceOn(i.from).withPieceOn(i.to,i.piece),moves:[{piece:i.piece,from:i.from,to:i.to,captured:o?{piece:o,onSquare:t}:void 0}]}:{board:e,moves:[]}}}function d(e){return void 0!==e&&"King"===e.name}function h(e){return void 0!==e&&"Rook"===e.name}
},{"./square":"uP5f","../pieces":"O6AC","@ddd-es-ts-chess/ddd-building-blocks-domain":"snZV"}],"c6VJ":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,r,t,o){void 0===o&&(o=t),Object.defineProperty(e,o,{enumerable:!0,get:function(){return r[t]}})}:function(e,r,t,o){void 0===o&&(o=t),e[o]=r[t]}),r=this&&this.__exportStar||function(r,t){for(var o in r)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||e(t,r,o)};Object.defineProperty(exports,"__esModule",{value:!0}),r(require("./chess-board"),exports),r(require("./chess-board-generator"),exports),r(require("./move"),exports),r(require("./square"),exports),r(require("./helper"),exports);
},{"./chess-board":"CFwr","./chess-board-generator":"lCXp","./move":"lCXp","./square":"uP5f","./helper":"MLWx"}],"swnP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractChessGameFailureDomainEvent=exports.AbstractChessGameSuccessDomainEvent=void 0;const e=require("@ddd-es-ts-chess/ddd-building-blocks-domain"),s=require("@ddd-es-ts-chess/ddd-building-blocks-domain");class t extends e.AbstractSuccessDomainEvent{constructor(e,s,t,r,a){super(e,s,t,r,a)}get aggregateType(){return"ChessGame"}get chessGameId(){return this.aggregateId}}exports.AbstractChessGameSuccessDomainEvent=t;class r extends s.AbstractFailureDomainEvent{constructor(e,s,t,r,a){super(e,s,t,r,a)}get aggregateType(){return"ChessGame"}get chessGameId(){return this.aggregateId}}exports.AbstractChessGameFailureDomainEvent=r;
},{"@ddd-es-ts-chess/ddd-building-blocks-domain":"snZV"}],"zH77":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CheckmateHasOccurred=void 0;const e=require("./chess-game-abstract-domain-event"),t=require("@ddd-es-ts-chess/ddd-building-blocks-domain");class s extends e.AbstractChessGameSuccessDomainEvent{constructor(){super(...arguments),this.toString=(()=>`CheckmateHasOccurred{chessGameId=${this.chessGameId}, occurredAt=${this.occurredAt}, data=${JSON.stringify(this.data)}, metadata=${JSON.stringify(this.metadata)}}`)}static event(e,a,r,c){return new s(t.DomainEventId.generate(),a,e,r,c)}}exports.CheckmateHasOccurred=s;
},{"./chess-game-abstract-domain-event":"swnP","@ddd-es-ts-chess/ddd-building-blocks-domain":"snZV"}],"r8BJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ChessGameFinished=void 0;const e=require("./chess-game-abstract-domain-event"),s=require("@ddd-es-ts-chess/ddd-building-blocks-domain");class t extends e.AbstractChessGameSuccessDomainEvent{constructor(){super(...arguments),this.toString=(()=>`ChessGameFinished{chessGameId=${this.chessGameId}, occurredAt=${this.occurredAt}, data=${JSON.stringify(this.data)}, metadata=${JSON.stringify(this.metadata)}}`)}static event(e,a,i,d){return new t(s.DomainEventId.generate(),a,e,i,d)}}exports.ChessGameFinished=t;
},{"./chess-game-abstract-domain-event":"swnP","@ddd-es-ts-chess/ddd-building-blocks-domain":"snZV"}],"i6ED":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ChessGameStarted=void 0;const e=require("./chess-game-abstract-domain-event"),t=require("@ddd-es-ts-chess/ddd-building-blocks-domain");class s extends e.AbstractChessGameSuccessDomainEvent{constructor(){super(...arguments),this.TYPE="ChessGameStarted",this.toString=(()=>`ChessGameStarted{chessGameId=${this.chessGameId}, occurredAt=${this.occurredAt}, data=${JSON.stringify(this.data)}, metadata=${JSON.stringify(this.metadata)}}`)}static event(e,a,r,d){return new s(t.DomainEventId.generate(),a,e,r,d)}}exports.ChessGameStarted=s;
},{"./chess-game-abstract-domain-event":"swnP","@ddd-es-ts-chess/ddd-building-blocks-domain":"snZV"}],"of6l":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ChessGameWasLost=void 0;const e=require("./chess-game-abstract-domain-event"),s=require("@ddd-es-ts-chess/ddd-building-blocks-domain");class t extends e.AbstractChessGameSuccessDomainEvent{constructor(){super(...arguments),this.toString=(()=>`ChessGameWasLost{chessGameId=${this.chessGameId}, occurredAt=${this.occurredAt}, data=${JSON.stringify(this.data)}, metadata=${JSON.stringify(this.metadata)}}`)}static event(e,a,r,d){return new t(s.DomainEventId.generate(),a,e,r,d)}}exports.ChessGameWasLost=t;
},{"./chess-game-abstract-domain-event":"swnP","@ddd-es-ts-chess/ddd-building-blocks-domain":"snZV"}],"K1DR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ChessGameWasWon=void 0;const e=require("./chess-game-abstract-domain-event"),s=require("@ddd-es-ts-chess/ddd-building-blocks-domain");class t extends e.AbstractChessGameSuccessDomainEvent{constructor(){super(...arguments),this.toString=(()=>`ChessGameWasWon{chessGameId=${this.chessGameId}, occurredAt=${this.occurredAt}, data=${JSON.stringify(this.data)}, metadata=${JSON.stringify(this.metadata)}}`)}static event(e,a,r,d){return new t(s.DomainEventId.generate(),a,e,r,d)}}exports.ChessGameWasWon=t;
},{"./chess-game-abstract-domain-event":"swnP","@ddd-es-ts-chess/ddd-building-blocks-domain":"snZV"}],"UkAN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KingWasChecked=void 0;const e=require("./chess-game-abstract-domain-event"),t=require("@ddd-es-ts-chess/ddd-building-blocks-domain");class s extends e.AbstractChessGameSuccessDomainEvent{constructor(){super(...arguments),this.toString=(()=>`KingWasChecked{chessGameId=${this.chessGameId}, occurredAt=${this.occurredAt}, data=${JSON.stringify(this.data)}, metadata=${JSON.stringify(this.metadata)}}`)}static event(e,a,d,i){return new s(t.DomainEventId.generate(),a,e,d,i)}}exports.KingWasChecked=s;
},{"./chess-game-abstract-domain-event":"swnP","@ddd-es-ts-chess/ddd-building-blocks-domain":"snZV"}],"P8Is":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KingWasUnchecked=void 0;const e=require("./chess-game-abstract-domain-event"),t=require("@ddd-es-ts-chess/ddd-building-blocks-domain");class s extends e.AbstractChessGameSuccessDomainEvent{constructor(){super(...arguments),this.toString=(()=>`KingWasUnchecked{chessGameId=${this.chessGameId}, occurredAt=${this.occurredAt}, data=${JSON.stringify(this.data)}, metadata=${JSON.stringify(this.metadata)}}`)}static event(e,a,c,d){return new s(t.DomainEventId.generate(),a,e,c,d)}}exports.KingWasUnchecked=s;
},{"./chess-game-abstract-domain-event":"swnP","@ddd-es-ts-chess/ddd-building-blocks-domain":"snZV"}],"SL54":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PawnPromotionWasEnabled=void 0;const e=require("./chess-game-abstract-domain-event"),t=require("@ddd-es-ts-chess/ddd-building-blocks-domain");class s extends e.AbstractChessGameSuccessDomainEvent{constructor(){super(...arguments),this.toString=(()=>`PawnPromotionWasEnabled{chessGameId=${this.chessGameId}, occurredAt=${this.occurredAt}, data=${JSON.stringify(this.data)}, metadata=${JSON.stringify(this.metadata)}}`)}static event(e,a,n,r){return new s(t.DomainEventId.generate(),a,e,n,r)}}exports.PawnPromotionWasEnabled=s;
},{"./chess-game-abstract-domain-event":"swnP","@ddd-es-ts-chess/ddd-building-blocks-domain":"snZV"}],"SFDk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PawnWasNotPromoted=void 0;const e=require("./chess-game-abstract-domain-event"),t=require("@ddd-es-ts-chess/ddd-building-blocks-domain");class s extends e.AbstractChessGameSuccessDomainEvent{constructor(){super(...arguments),this.toString=(()=>`PawnWasNotPromoted{chessGameId=${this.chessGameId}, occurredAt=${this.occurredAt}, data=${JSON.stringify(this.data)}, metadata=${JSON.stringify(this.metadata)}}`)}static event(e,a,r,o){return new s(t.DomainEventId.generate(),a,e,r,o)}}exports.PawnWasNotPromoted=s;
},{"./chess-game-abstract-domain-event":"swnP","@ddd-es-ts-chess/ddd-building-blocks-domain":"snZV"}],"KcIS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PawnWasPromoted=void 0;const e=require("./chess-game-abstract-domain-event"),t=require("@ddd-es-ts-chess/ddd-building-blocks-domain");class s extends e.AbstractChessGameSuccessDomainEvent{constructor(){super(...arguments),this.toString=(()=>`PawnWasPromoted{chessGameId=${this.chessGameId}, occurredAt=${this.occurredAt}, data=${JSON.stringify(this.data)}, metadata=${JSON.stringify(this.metadata)}}`)}static event(e,a,r,d){return new s(t.DomainEventId.generate(),a,e,r,d)}}exports.PawnWasPromoted=s;
},{"./chess-game-abstract-domain-event":"swnP","@ddd-es-ts-chess/ddd-building-blocks-domain":"snZV"}],"QCPe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PieceWasCaptured=void 0;const e=require("./chess-game-abstract-domain-event"),t=require("@ddd-es-ts-chess/ddd-building-blocks-domain");class s extends e.AbstractChessGameSuccessDomainEvent{constructor(){super(...arguments),this.toString=(()=>`PieceWasCaptured{chessGameId=${this.chessGameId}, occurredAt=${this.occurredAt}, data=${JSON.stringify(this.data)}, metadata=${JSON.stringify(this.metadata)}}`)}static event(e,a,r,d){return new s(t.DomainEventId.generate(),a,e,r,d)}}exports.PieceWasCaptured=s;
},{"./chess-game-abstract-domain-event":"swnP","@ddd-es-ts-chess/ddd-building-blocks-domain":"snZV"}],"UCGH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PieceWasMoved=void 0;const e=require("./chess-game-abstract-domain-event"),t=require("@ddd-es-ts-chess/ddd-building-blocks-domain");class s extends e.AbstractChessGameSuccessDomainEvent{constructor(){super(...arguments),this.toString=(()=>`PieceWasMoved{chessGameId=${this.chessGameId}, occurredAt=${this.occurredAt}, data=${JSON.stringify(this.data)}, metadata=${JSON.stringify(this.metadata)}}`)}static event(e,a,d,i){return new s(t.DomainEventId.generate(),a,e,d,i)}}exports.PieceWasMoved=s;
},{"./chess-game-abstract-domain-event":"swnP","@ddd-es-ts-chess/ddd-building-blocks-domain":"snZV"}],"fKHW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PieceWasNotMoved=void 0;const e=require("./chess-game-abstract-domain-event"),t=require("@ddd-es-ts-chess/ddd-building-blocks-domain");class s extends e.AbstractChessGameFailureDomainEvent{constructor(){super(...arguments),this.toString=(()=>`PieceWasNotMoved{chessGameId=${this.chessGameId}, occurredAt=${this.occurredAt}, data=${JSON.stringify(this.data)}, metadata=${JSON.stringify(this.metadata)}}`)}static event(e,a,i,r){return new s(t.DomainEventId.generate(),a,e,i,r)}}exports.PieceWasNotMoved=s;
},{"./chess-game-abstract-domain-event":"swnP","@ddd-es-ts-chess/ddd-building-blocks-domain":"snZV"}],"V55s":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StalemateHasOccurred=void 0;const e=require("./chess-game-abstract-domain-event"),t=require("@ddd-es-ts-chess/ddd-building-blocks-domain");class s extends e.AbstractChessGameSuccessDomainEvent{constructor(){super(...arguments),this.toString=(()=>`StalemateHasOccurred{chessGameId=${this.chessGameId}, occurredAt=${this.occurredAt}, data=${JSON.stringify(this.data)}, metadata=${JSON.stringify(this.metadata)}}`)}static event(e,a,r,c){return new s(t.DomainEventId.generate(),a,e,r,c)}}exports.StalemateHasOccurred=s;
},{"./chess-game-abstract-domain-event":"swnP","@ddd-es-ts-chess/ddd-building-blocks-domain":"snZV"}],"jVg6":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,r,t,s){void 0===s&&(s=t),Object.defineProperty(e,s,{enumerable:!0,get:function(){return r[t]}})}:function(e,r,t,s){void 0===s&&(s=t),e[s]=r[t]}),r=this&&this.__exportStar||function(r,t){for(var s in r)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||e(t,r,s)};Object.defineProperty(exports,"__esModule",{value:!0}),r(require("./checkmate-has-occurred"),exports),r(require("./chess-game-abstract-domain-event"),exports),r(require("./chess-game-finished"),exports),r(require("./chess-game-started"),exports),r(require("./chess-game-was-lost"),exports),r(require("./chess-game-was-won"),exports),r(require("./king-was-checked"),exports),r(require("./king-was-unchecked"),exports),r(require("./pawn-promotion-was-enabled"),exports),r(require("./pawn-was-not-promoted"),exports),r(require("./pawn-was-promoted"),exports),r(require("./piece-was-captured"),exports),r(require("./piece-was-moved"),exports),r(require("./piece-was-not-moved"),exports),r(require("./stalemate-has-occurred"),exports);
},{"./checkmate-has-occurred":"zH77","./chess-game-abstract-domain-event":"swnP","./chess-game-finished":"r8BJ","./chess-game-started":"i6ED","./chess-game-was-lost":"of6l","./chess-game-was-won":"K1DR","./king-was-checked":"UkAN","./king-was-unchecked":"P8Is","./pawn-promotion-was-enabled":"SL54","./pawn-was-not-promoted":"SFDk","./pawn-was-promoted":"KcIS","./piece-was-captured":"QCPe","./piece-was-moved":"UCGH","./piece-was-not-moved":"fKHW","./stalemate-has-occurred":"V55s"}],"WQMC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ChessGameHistoryLog=void 0;class t{constructor(t){this.gameHistory=t}static empty(){return new t([])}record(e){return new t([...this.gameHistory,e])}last(){return[...this.gameHistory].pop()}forgetLast(){const e=[...this.gameHistory];return e.pop(),new t(e)}}exports.ChessGameHistoryLog=t;
},{}],"ckhn":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),t=this&&this.__exportStar||function(t,r){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(r,i)||e(r,t,i)};Object.defineProperty(exports,"__esModule",{value:!0}),t(require("./chess-game-history-log"),exports);
},{"./chess-game-history-log":"WQMC"}],"mTGs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ChessGameNotStarted=void 0;const e=require("./chess-game-abstract-domain-event"),t=require("@ddd-es-ts-chess/ddd-building-blocks-domain");class s extends e.AbstractChessGameFailureDomainEvent{constructor(){super(...arguments),this.toString=(()=>`ChessGameNotStarted{chessGameId=${this.chessGameId}, occurredAt=${this.occurredAt}, data=${JSON.stringify(this.data)}, metadata=${JSON.stringify(this.metadata)}}`)}static event(e,a,r,d){return new s(t.DomainEventId.generate(),a,e,r,d)}}exports.ChessGameNotStarted=s;
},{"./chess-game-abstract-domain-event":"swnP","@ddd-es-ts-chess/ddd-building-blocks-domain":"snZV"}],"HMc5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ChessGame=void 0;const e=require("../pieces"),t=require("../pieces"),s=require("@ddd-es-ts-chess/ddd-building-blocks-domain"),i=require("../event/piece-was-not-moved"),r=require("../event/piece-was-moved"),a=require("../event"),o=require("../event"),n=require("../event"),d=require("../event"),c=require("../event"),h=require("../event"),u=require("@ddd-es-ts-chess/ddd-building-blocks-domain"),m=require("../history"),v=require("../event"),f=require("../event"),l=require("../event"),p=require("../event"),g=require("@ddd-es-ts-chess/ddd-building-blocks-domain"),P=require("@ddd-es-ts-chess/ddd-building-blocks-domain"),I=require("../event/chess-game-not-started");class q{constructor(t){this.timeProvider=t,this.gameHistory=m.ChessGameHistoryLog.empty(),this.events=P.DomainEvents.clean(),this.start=(e=>{const t=u.CausationId.generate(),i={correlationId:t.toCorrelation(),causationId:t};if(this.state&&this.state.started){const t={reason:"Chess game has already started!"};return s.Result.failure(I.ChessGameNotStarted.event(e.id,this.timeProvider.currentDate(),t,i))}const r=v.ChessGameStarted.event(e.id,this.timeProvider.currentDate(),{chessGameId:e.id,chessBoard:e.chessBoard,startSide:e.startSide,players:e.players},i),a=s.Result.success(r);return a.handleEvents(this.onEvent),a}),this.movePiece=(e=>this.executeCommand(({chessGameId:t,occurredAt:a},o)=>{if(!this.state.started){const r={from:e.from,to:e.to,reason:"Chess game has not already started!"};return s.Result.failure(i.PieceWasNotMoved.event(t,a,r,o))}if(this.state.finished){const r={from:e.from,to:e.to,reason:"Chess game has already finished!"};return s.Result.failure(i.PieceWasNotMoved.event(t,a,r,o))}if(this.state.currentPromotion){const r={from:e.from,to:e.to,reason:`Promotion for #${this.state.currentPromotion.pawn.side} on square ${this.state.currentPromotion.onSquare} is in progress!`};return s.Result.failure(i.PieceWasNotMoved.event(t,a,r,o))}const n=this.state.chessBoard.pieceOn(e.from);if(!g.isDefined(n)||n.side!==this.sideOf(e.by)){const r={from:e.from,to:e.to,reason:`Piece on square ${e.from.algebraicNotation} is not piece of players with id ${e.by.toString()}!`};return s.Result.failure(i.PieceWasNotMoved.event(t,a,r,o))}if(!g.isDefined(n)||n.side!==this.state.currentSide){const r={from:e.from,to:e.to,reason:`Piece on square ${e.from.algebraicNotation} is not current player selected piece!`};return s.Result.failure(i.PieceWasNotMoved.event(t,a,r,o))}if(!n.getAvailableMoves(this.state.chessBoard,e.from).map(e=>e.square.id).includes(e.to.id)){const r={from:e.from,to:e.to,reason:"Selected square is not available for the piece!"};return s.Result.failure(i.PieceWasNotMoved.event(t,a,r,o))}const d=this.state.chessBoard.withMovedPiece(n,e.from,e.to).moves.map(e=>this.calculateMoveEffect(r.PieceWasMoved.event(t,a,e,o))).reduce((e,t)=>[...e,...t]);return s.Result.success(d)})),this.promotePawn=((e,t,i)=>this.executeCommand(({chessGameId:r,occurredAt:a},n)=>{if(g.isNotDefined(this.state.currentPromotion)||this.state.currentPromotion.onSquare!==t){const e={onSquare:t,reason:`No current promotion on square ${t.algebraicNotation}!`};return s.Result.failure(c.PawnWasNotPromoted.event(r,a,e,n))}if(g.isDefined(this.state.currentPromotion)&&this.state.currentPromotion.pawn.side!==this.sideOf(e)){const i={onSquare:t,reason:`Pawn to promotion does not belongs to player with id ${e}!`};return s.Result.failure(c.PawnWasNotPromoted.event(r,a,i,n))}const h=[],u={onSquare:t,from:this.state.currentPromotion.pawn,to:i};h.push(d.PawnWasPromoted.event(r,this.timeProvider.currentDate(),u,n));const m=this.state.chessBoard.withPieceOn(u.onSquare,u.to).checkedKing();return g.isDefined(m)&&h.push(o.KingWasChecked.event(r,a,{king:m.piece,onSquare:m.square},n)),s.Result.success(h)})),this.stateChangeEventHandlers={ChessGameStarted:({data:e})=>({id:e.chessGameId,chessBoard:e.chessBoard,currentSide:e.startSide,players:e.players,checkedKing:void 0,currentPromotion:void 0,finished:!1,started:!0}),KingWasChecked:({data:e})=>({checkedKing:{piece:e.king,square:e.onSquare}}),KingWasUnchecked:()=>({checkedKing:void 0}),PieceWasMoved:({data:t})=>({chessBoard:this.state.chessBoard.withMovedPiece(t.piece,t.from,t.to).board,currentSide:e.Side.another(t.piece.side)}),PawnWasPromoted:({data:e})=>({chessBoard:this.state.chessBoard.withPieceOn(e.onSquare,e.to),currentPromotion:void 0}),PawnPromotionWasEnabled:({data:e})=>({currentPromotion:e}),ChessGameFinished:()=>({finished:!0})},this.onEvent=((e,t=!1)=>{t||(this.events=this.events.append(e)),e instanceof r.PieceWasMoved&&this.recordToHistory(this.state);const s=this.stateChangeEventHandlers[e.eventType];if(s){const t=s(e);this.updateState(t)}return this})}static with(e){return new q(e.timeProvider)}static from(e){return t=>{if(!e||0===e.length)throw new Error("Cannot reconstruct chess game from empty events");const[s]=e;if(!(s instanceof v.ChessGameStarted))throw new Error("Invalid first event!");return e.reduce((e,t)=>e.onEvent(t,!0),q.with({timeProvider:t}))}}sideOf(t){return t.equals(this.state.players.white)?e.Side.WHITE:t.equals(this.state.players.black)?e.Side.BLACK:void 0}calculateMoveEffect(t){const s=[t],i=this.pieceCaptureMoveEffect(t);i&&s.push(i);const r=this.pawnPromotionMoveEffect(t);r&&s.push(r);const a=this.kingCheckMoveEffect(t);a&&s.push(a);const o=this.checkmateMoveEffect(t);o&&(s.push(o),s.push(p.ChessGameFinished.event(this.state.id,this.timeProvider.currentDate(),{result:{name:"Win",winner:e.Side.another(o.data.king.side),reason:{name:"Checkmate",kingOn:o.data.king.side}}},{correlationId:o.metadata.correlationId,causationId:u.CausationId.fromEventId(o.eventId)})));const n=this.stalemateMoveEffect(t);return n&&(s.push(n),s.push(p.ChessGameFinished.event(this.state.id,this.timeProvider.currentDate(),{result:{name:"Draw",reason:{name:"Stalemate",on:n.data.for}}},{correlationId:n.metadata.correlationId,causationId:u.CausationId.fromEventId(n.eventId)}))),s}kingCheckMoveEffect({eventId:e,data:t,metadata:s}){const i=t,r=this.state.chessBoard.withMovedPiece(i.piece,i.from,i.to).board.checkedKing();return r?o.KingWasChecked.event(this.state.id,this.timeProvider.currentDate(),{king:r.piece,onSquare:r.square},Object.assign(Object.assign({},s),{causationId:u.CausationId.fromEventId(e)})):this.state.checkedKing?n.KingWasUnchecked.event(this.state.id,this.timeProvider.currentDate(),{king:this.state.checkedKing.piece,onSquare:this.state.checkedKing.square,afterMove:i},Object.assign(Object.assign({},s),{causationId:u.CausationId.fromEventId(e)})):void 0}pawnPromotionMoveEffect({eventId:e,data:s,metadata:i}){const r=s;if(t.Pawn.isPawn(r.piece)&&r.piece.isOnTheOppositeEdgeOfTheBoard(r.to))return a.PawnPromotionWasEnabled.event(this.state.id,this.timeProvider.currentDate(),{onSquare:r.to,pawn:r.piece},Object.assign(Object.assign({},i),{causationId:u.CausationId.fromEventId(e)}))}pieceCaptureMoveEffect({eventId:e,data:t,metadata:s}){const i=t;if(i.captured)return h.PieceWasCaptured.event(this.state.id,this.timeProvider.currentDate(),{onSquare:i.captured.onSquare,piece:i.captured.piece,byMove:{piece:i.piece,from:i.from,to:i.to}},Object.assign(Object.assign({},s),{causationId:u.CausationId.fromEventId(e)}))}checkmateMoveEffect({eventId:e,data:t,metadata:s}){const i=t,r=this.state.chessBoard.checkedKing();if(r&&r.piece.isCheckmate(this.state.chessBoard,r.square))return f.CheckmateHasOccurred.event(this.state.id,this.timeProvider.currentDate(),{onSquare:r.square,king:r.piece,byMove:{piece:i.piece,from:i.from,to:i.to}},Object.assign(Object.assign({},s),{causationId:u.CausationId.fromEventId(e)}))}stalemateMoveEffect({eventId:t,data:s,metadata:i}){const r=s,a=e=>this.state.chessBoard.isStalemateFor(e),o=a(e.Side.WHITE)?e.Side.WHITE:a(e.Side.BLACK)?e.Side.BLACK:void 0;if(o)return l.StalemateHasOccurred.event(this.state.id,this.timeProvider.currentDate(),{for:o,byMove:{piece:r.piece,from:r.from,to:r.to}},Object.assign(Object.assign({},i),{causationId:u.CausationId.fromEventId(t)}))}recordToHistory(e){const t={currentSide:e.currentSide,chessBoard:e.chessBoard,timestamp:this.timeProvider.currentDate(),checkedKing:e.checkedKing};this.gameHistory=this.gameHistory.record(t)}get board(){return this.state.chessBoard}get currentSide(){return this.state.currentSide}movesForPiece(e,t){const s=this.state.chessBoard.pieceOn(e);return g.isDefined(s)&&s.side===t?s.getAvailableMoves(this.state.chessBoard,e):void 0}undoLastMove(){const e=this.gameHistory.last();e&&(this.updateState({chessBoard:e.chessBoard,currentSide:e.currentSide,checkedKing:e.checkedKing}),this.gameHistory=this.gameHistory.forgetLast())}executeCommand(e){const t=u.CausationId.generate(),s=t.toCorrelation(),i=e({chessGameId:this.state.id,occurredAt:this.timeProvider.currentDate()},{causationId:t,correlationId:s});return i.handleEvents(this.onEvent),i}updateState(e){this.state=Object.assign(Object.assign({},this.state),e)}get id(){return this.state.id}get uncommittedEvents(){return this.events.toArray()}}exports.ChessGame=q;
},{"../pieces":"O6AC","@ddd-es-ts-chess/ddd-building-blocks-domain":"snZV","../event/piece-was-not-moved":"fKHW","../event/piece-was-moved":"UCGH","../event":"jVg6","../history":"ckhn","../event/chess-game-not-started":"mTGs"}],"KFkL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("./regex.js"));function t(e){return e&&e.__esModule?e:{default:e}}function r(t){return"string"==typeof t&&e.default.test(t)}var u=r;exports.default=u;
},{"./regex.js":"g0si"}],"wFJ2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("./validate.js"));function r(e){return e&&e.__esModule?e:{default:e}}for(var t=[],i=0;i<256;++i)t.push((i+256).toString(16).substr(1));function o(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=(t[r[i+0]]+t[r[i+1]]+t[r[i+2]]+t[r[i+3]]+"-"+t[r[i+4]]+t[r[i+5]]+"-"+t[r[i+6]]+t[r[i+7]]+"-"+t[r[i+8]]+t[r[i+9]]+"-"+t[r[i+10]]+t[r[i+11]]+t[r[i+12]]+t[r[i+13]]+t[r[i+14]]+t[r[i+15]]).toLowerCase();if(!(0,e.default)(o))throw TypeError("Stringified UUID is invalid");return o}var u=o;exports.default=u;
},{"./validate.js":"KFkL"}],"gJwA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e,r,s=o(require("./rng.js")),n=o(require("./stringify.js"));function o(e){return e&&e.__esModule?e:{default:e}}var u=0,t=0;function a(o,a,l){var d=a&&l||0,i=a||new Array(16),c=(o=o||{}).node||e,v=void 0!==o.clockseq?o.clockseq:r;if(null==c||null==v){var f=o.random||(o.rng||s.default)();null==c&&(c=e=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==v&&(v=r=16383&(f[6]<<8|f[7]))}var q=void 0!==o.msecs?o.msecs:Date.now(),m=void 0!==o.nsecs?o.nsecs:t+1,p=q-u+(m-t)/1e4;if(p<0&&void 0===o.clockseq&&(v=v+1&16383),(p<0||q>u)&&void 0===o.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=q,t=m,r=v;var w=(1e4*(268435455&(q+=122192928e5))+m)%4294967296;i[d++]=w>>>24&255,i[d++]=w>>>16&255,i[d++]=w>>>8&255,i[d++]=255&w;var _=q/4294967296*1e4&268435455;i[d++]=_>>>8&255,i[d++]=255&_,i[d++]=_>>>24&15|16,i[d++]=_>>>16&255,i[d++]=v>>>8|128,i[d++]=255&v;for(var g=0;g<6;++g)i[d+g]=c[g];return a||(0,n.default)(i)}var l=a;exports.default=l;
},{"./rng.js":"NiBi","./stringify.js":"wFJ2"}],"k6p3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("./validate.js"));function r(e){return e&&e.__esModule?e:{default:e}}function t(r){if(!(0,e.default)(r))throw TypeError("Invalid UUID");var t,s=new Uint8Array(16);return s[0]=(t=parseInt(r.slice(0,8),16))>>>24,s[1]=t>>>16&255,s[2]=t>>>8&255,s[3]=255&t,s[4]=(t=parseInt(r.slice(9,13),16))>>>8,s[5]=255&t,s[6]=(t=parseInt(r.slice(14,18),16))>>>8,s[7]=255&t,s[8]=(t=parseInt(r.slice(19,23),16))>>>8,s[9]=255&t,s[10]=(t=parseInt(r.slice(24,36),16))/1099511627776&255,s[11]=t/4294967296&255,s[12]=t>>>24&255,s[13]=t>>>16&255,s[14]=t>>>8&255,s[15]=255&t,s}var s=t;exports.default=s;
},{"./validate.js":"KFkL"}],"KJz6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=s,exports.URL=exports.DNS=void 0;var e=t(require("./stringify.js")),r=t(require("./parse.js"));function t(e){return e&&e.__esModule?e:{default:e}}function n(e){e=unescape(encodeURIComponent(e));for(var r=[],t=0;t<e.length;++t)r.push(e.charCodeAt(t));return r}var a="6ba7b810-9dad-11d1-80b4-00c04fd430c8";exports.DNS=a;var o="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function s(t,s,u){function i(t,a,o,i){if("string"==typeof t&&(t=n(t)),"string"==typeof a&&(a=(0,r.default)(a)),16!==a.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var d=new Uint8Array(16+t.length);if(d.set(a),d.set(t,a.length),(d=u(d))[6]=15&d[6]|s,d[8]=63&d[8]|128,o){i=i||0;for(var f=0;f<16;++f)o[i+f]=d[f];return o}return(0,e.default)(d)}try{i.name=t}catch(d){}return i.DNS=a,i.URL=o,i}exports.URL=o;
},{"./stringify.js":"wFJ2","./parse.js":"k6p3"}],"VizO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("./v35.js")),r=t(require("./md5.js"));function t(e){return e&&e.__esModule?e:{default:e}}var u=(0,e.default)("v3",48,r.default),d=u;exports.default=d;
},{"./v35.js":"KJz6","./md5.js":"z47x"}],"sE4T":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("./rng.js")),r=t(require("./stringify.js"));function t(e){return e&&e.__esModule?e:{default:e}}function u(t,u,n){var a=(t=t||{}).random||(t.rng||e.default)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,u){n=n||0;for(var f=0;f<16;++f)u[n+f]=a[f];return u}return(0,r.default)(a)}var n=u;exports.default=n;
},{"./rng.js":"NiBi","./stringify.js":"wFJ2"}],"msOM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("./v35.js")),r=t(require("./sha1.js"));function t(e){return e&&e.__esModule?e:{default:e}}var u=(0,e.default)("v5",80,r.default),s=u;exports.default=s;
},{"./v35.js":"KJz6","./sha1.js":"UaB7"}],"a3hK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("./validate.js"));function r(e){return e&&e.__esModule?e:{default:e}}function t(r){if(!(0,e.default)(r))throw TypeError("Invalid UUID");return parseInt(r.substr(14,1),16)}var u=t;exports.default=u;
},{"./validate.js":"KFkL"}],"uvJW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"v1",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(exports,"v3",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(exports,"v4",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(exports,"v5",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(exports,"NIL",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(exports,"version",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(exports,"validate",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(exports,"stringify",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(exports,"parse",{enumerable:!0,get:function(){return s.default}});var e=a(require("./v1.js")),r=a(require("./v3.js")),t=a(require("./v4.js")),n=a(require("./v5.js")),u=a(require("./nil.js")),i=a(require("./version.js")),o=a(require("./validate.js")),f=a(require("./stringify.js")),s=a(require("./parse.js"));function a(e){return e&&e.__esModule?e:{default:e}}
},{"./v1.js":"gJwA","./v3.js":"VizO","./v4.js":"sE4T","./v5.js":"msOM","./nil.js":"bKUh","./version.js":"a3hK","./validate.js":"KFkL","./stringify.js":"wFJ2","./parse.js":"k6p3"}],"WrAM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ChessGameId=void 0;const e=require("uuid");class t{constructor(e){this.raw=e,this.TYPE="ChessGameId"}static of(e){return new t(e)}static generate(){return new t(e.v4())}toString(){return this.raw}}exports.ChessGameId=t;
},{"uuid":"uvJW"}],"Q04P":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PromotionAvailabilityPolicy=void 0;class o{}exports.PromotionAvailabilityPolicy=o;
},{}],"Zs9U":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PlayerId=void 0;class r{constructor(r){this.raw=r,this.TYPE="PlayerId"}static of(e){return new r(e)}toString(){return this.raw}equals(r){return void 0!==r&&r.raw.toLowerCase()===this.raw.toLowerCase()}}exports.PlayerId=r;
},{}],"rgQL":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,r,t,i){void 0===i&&(i=t),Object.defineProperty(e,i,{enumerable:!0,get:function(){return r[t]}})}:function(e,r,t,i){void 0===i&&(i=t),e[i]=r[t]}),r=this&&this.__exportStar||function(r,t){for(var i in r)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||e(t,r,i)};Object.defineProperty(exports,"__esModule",{value:!0}),r(require("./chess-game"),exports),r(require("./chess-game-id"),exports),r(require("./promotion-availability-policy"),exports),r(require("./stalemate-policy"),exports),r(require("./player-id"),exports);
},{"./chess-game":"HMc5","./chess-game-id":"WrAM","./promotion-availability-policy":"Q04P","./stalemate-policy":"lCXp","./player-id":"Zs9U"}],"FWrI":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,r,t,i){void 0===i&&(i=t),Object.defineProperty(e,i,{enumerable:!0,get:function(){return r[t]}})}:function(e,r,t,i){void 0===i&&(i=t),e[i]=r[t]}),r=this&&this.__exportStar||function(r,t){for(var i in r)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||e(t,r,i)};Object.defineProperty(exports,"__esModule",{value:!0}),r(require("./board"),exports),r(require("./event"),exports),r(require("./game"),exports),r(require("./history"),exports),r(require("./pieces"),exports);
},{"./board":"c6VJ","./event":"jVg6","./game":"rgQL","./history":"ckhn","./pieces":"O6AC"}],"k2Ou":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(){}return e.getBy=function(e,t){return'<i class="fas fa-chess-'+e.toLowerCase()+" "+t+'"></i>'},e}();exports.default=e;
},{}],"xP6w":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.SquareView=void 0;var t=require("@ddd-es-ts-chess/chess-domain"),i=e(require("./font-awesome/font-awesome-piece-icons")),s=require("@ddd-es-ts-chess/chess-domain"),r=function(){function e(e,i,r,n){void 0===r&&(r=!1),void 0===n&&(n=!1),this.isChecked=!1,this.isSelected=!1,this.square=e instanceof s.Square?e:s.Square.at(s.Column.fromCharacter(t.columnNumberToCharacter(e.column)),s.Row.fromNumber(e.row)),this.piece=i(this.square),this.isChecked=r,this.isSelected=n}return e.withoutPiece=function(t){return new e(t,function(){})},e.fromHtml=function(t){var i=t.id,r=t.firstElementChild,n=r?s.Pieces.getBy(r.getAttribute("app-name"),r.getAttribute("app-side")):void 0;return new e(s.Square.withId(i),function(){return n},t.classList.contains("checked-square"),!!r&&r.classList.contains("app-selected-square"))},e.prototype.withoutPiece=function(){return new e(this.square,function(){},this.isChecked,this.isSelected)},e.prototype.withPiece=function(t){return new e(this.square,function(){return t},this.isChecked,this.isSelected)},e.prototype.checked=function(){var t=this;return new e(this.square,function(){return t.piece},!0,this.isSelected)},e.prototype.unchecked=function(){var t=this;return new e(this.square,function(){return t.piece},!1,this.isSelected)},e.prototype.selected=function(){var t=this;return new e(this.square,function(){return t.piece},this.isChecked,!0)},e.prototype.notSelected=function(){var t=this;return new e(this.square,function(){return t.piece},this.isChecked,!1)},Object.defineProperty(e.prototype,"pieceOnSquare",{get:function(){return this.piece},enumerable:!1,configurable:!0}),e.prototype.html=function(){var e=document.createElement("div");if(e.id=this.square.id,e.classList.add("square"),e.classList.add(this.square.row.number%2==this.square.column.number%2?"light":"dark"),this.isChecked&&e.classList.add("checked-square"),void 0!==this.piece){e.innerHTML=i.default.getBy(this.piece.name,this.piece.side);var t=e.firstElementChild;t&&(t.setAttribute("app-name",this.piece.name),t.setAttribute("app-side",this.piece.side),t.classList.add("app-piece-icon"),this.isSelected&&e.classList.add("app-selected-square"))}return e},e}();exports.SquareView=r;
},{"@ddd-es-ts-chess/chess-domain":"FWrI","./font-awesome/font-awesome-piece-icons":"k2Ou"}],"B5NP":[function(require,module,exports) {
"use strict";var e=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<o;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,n++)r[n]=i[a];return r};Object.defineProperty(exports,"__esModule",{value:!0});var t=require("@ddd-es-ts-chess/chess-domain"),o=require("@ddd-es-ts-chess/chess-domain"),r=require("./square-view"),n="I",i="normal-move",a="attack-move",s=function(){function s(e,t){this.chessBoardPresenter=e(this),this.chessGameHistoryPresenter=t(this),this.chessBoardPresenter.loadChessBoard(),this.registerBoardClickListener(),this.registerUndoButtonClickListener()}return s.prototype.showChessBoard=function(e){for(var t=e.width;t>=1;t--)for(var o=1;o<=e.height;o++){var n=new r.SquareView({column:o,row:t},function(t){return e.pieceOn(t)});this.boardHtmlElement().appendChild(n.html())}},s.prototype.clearChessBoard=function(){for(;this.boardHtmlElement().firstChild;)this.boardHtmlElement().removeChild(this.boardHtmlElement().firstChild)},s.prototype.boardHtmlElement=function(){return document.getElementById("board")},s.prototype.registerBoardClickListener=function(){this.boardHtmlElement().addEventListener("click",this.boardTouched.bind(this))},s.prototype.registerUndoButtonClickListener=function(){document.querySelector("#undoBtn").addEventListener("click",this.undoLastMove.bind(this))},s.prototype.showPieceIcon=function(e,o,n){var i=document.getElementById(e);if(i&&i.parentNode){var a=r.SquareView.fromHtml(i);i.parentNode.replaceChild(a.withPiece(t.Pieces.getBy(o,n)).html(),i)}},s.prototype.boardTouched=function(e){var t=this.clickedSquareView(e);this.chessBoardPresenter.selectSquare(t.square)},s.prototype.showPawnPromotionSelection=function(e,r){var n=prompt("You can promote your pawn. Choose the new piece.","Queen"),i=null==n?void 0:n;i&&t.isPromotionPieceName(i)?this.chessBoardPresenter.promotePawn(o.PlayerId.of(r),e,t.Pieces.getBy(i,r)):this.showInvalidPieceNameAlert(i,e,r)},s.prototype.changePawnToPromoted=function(e,t){this.showPieceIcon(e.id,t.name,t.side)},s.prototype.showCurrentSide=function(e){var t=document.getElementById("app-current-player");t&&(t.innerHTML="<p>Current player: "+e+"</p>")},s.prototype.showInvalidPieceNameAlert=function(e,t,o){alert("Invalid piece name: "+e),this.showPawnPromotionSelection(t,o)},s.prototype.showSelectedPieceAvailableMoves=function(e){this.showAvailableMoves(e)},s.prototype.moveSelectedPiece=function(e){this.hidePieceIcon(e.from,e.piece),this.showPieceIcon(e.to.id,e.piece.name,e.piece.side),this.hideSelectedPieceAvailableMoves()},s.prototype.removeCapturedPiece=function(e,t){this.hidePieceIcon(e,t)},s.prototype.hidePieceIcon=function(e,t){var o=e.id,n=document.getElementById(o);if(n&&n.parentNode){var i=r.SquareView.fromHtml(n);t.equals(i.pieceOnSquare)&&n.parentNode.replaceChild(i.withoutPiece().html(),n)}},s.prototype.clickedSquareView=function(e){var t=e.target,o=this.isPieceIconClicked(e)?t.parentNode:t;return r.SquareView.fromHtml(o)},s.prototype.isPieceIconClicked=function(e){return e.target.tagName===n},s.prototype.showAvailableMoves=function(e){for(var o=0,r=e;o<r.length;o++){var n=r[o];n.type===t.MoveType.ATTACK?document.getElementById(n.square.id).classList.add(a):document.getElementById(n.square.id).classList.add(i)}},s.prototype.hideSelectedPieceAvailableMoves=function(){for(var t=e(document.getElementsByClassName(i),document.getElementsByClassName(a)),o=0;o<t.length;o++)t[o].classList.remove(i,a)},s.prototype.undoLastMove=function(){this.chessGameHistoryPresenter.undoLastMove()},s.prototype.onLastMoveUndone=function(){this.clearChessBoard(),this.chessBoardPresenter.loadChessBoard()},s.prototype.checkKingOn=function(e){var t=e.id,o=document.getElementById(t);if(o&&o.parentNode){var n=r.SquareView.fromHtml(o);o.parentNode.replaceChild(n.checked().html(),o)}},s.prototype.uncheckKing=function(){for(var e=document.getElementsByClassName("checked-square"),t=0;t<e.length;t++){var o=e[t];if(o&&o.parentNode){var n=r.SquareView.fromHtml(o);o.parentNode.replaceChild(n.unchecked().html(),o)}}},s.prototype.showSelectedPieceOn=function(e){var t=e.id,o=document.getElementById(t);if(o&&o.parentNode){var n=r.SquareView.fromHtml(o);o.parentNode.replaceChild(n.selected().html(),o)}},s.prototype.notShowSelectedPiece=function(){for(var e=document.getElementsByClassName("app-selected-square"),t=0;t<e.length;t++){var o=e[t];if(o&&o.parentNode){var n=r.SquareView.fromHtml(o);o.parentNode.replaceChild(n.notSelected().html(),o)}}},s.prototype.showGameResult=function(e){var t=document.getElementById("app-game-result");t&&(t.innerHTML="<p>Game finished with "+e.reason.name+" "+("Win"===e.name?"The winner is: "+e.winner:"Nobody won!")+"</p>")},s}();exports.default=s;
},{"@ddd-es-ts-chess/chess-domain":"FWrI","./square-view":"xP6w"}],"CUyU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EMOJIS_START_CONFIG=void 0;const e=["A","B","C","D","E","F","G","H"];exports.EMOJIS_START_CONFIG={8:["♜","♞","♝","♛","♚","♝","♞","♜"],7:["♟","♟","♟","♟","♟","♟","♟","♟"],6:[" "," "," "," "," "," "," "," "],5:[" "," "," "," "," "," "," "," "],4:[" "," "," "," "," "," "," "," "],3:[" "," "," "," "," "," "," "," "],2:["♙","♙","♙","♙","♙","♙","♙","♙"],1:["♖","♘","♗","♕","♔","♗","♘","♖"],0:["A","B","C","D","E","F","G","H"]};
},{}],"V0Ji":[function(require,module,exports) {
"use strict";function e(e){return void 0!==e&&exports.whitePieceEmojis.includes(e)}function i(e){return void 0!==e&&exports.blackPieceEmojis.includes(e)}function o(o){return e(o)||i(o)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isPieceEmoji=exports.isBlackPieceEmoji=exports.isWhitePieceEmoji=exports.whitePieceEmojis=exports.blackPieceEmojis=void 0,exports.blackPieceEmojis=["♟","♜","♞","♝","♛","♚"],exports.whitePieceEmojis=["♙","♖","♘","♗","♕","♔"],exports.isWhitePieceEmoji=e,exports.isBlackPieceEmoji=i,exports.isPieceEmoji=o;
},{}],"oRRl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PieceEmojis=void 0;const e=require("./piece-emoji"),t=["King","Queen","Bishop","Knight","Rook","Pawn"];function i(t){return e.isBlackPieceEmoji(t)?"black":"white"}const o={Bishop:{black:"♝",white:"♗"},Knight:{black:"♞",white:"♘"},Pawn:{black:"♟",white:"♙"},Queen:{black:"♛",white:"♕"},Rook:{black:"♜",white:"♖"},King:{white:"♔",black:"♚"}};class c{static toIcon(e,t){return o[e][t]}static toPiece(e){const t=Object.keys(o).map(e=>e).find(t=>{const i=o[t];return i.black===e||i.white===e});if(!t)throw new Error(`Lack of mapping for emoji ${e}`);return{name:t,side:i(e)}}toIcon(e,t){return c.toIcon(e,t)}toPiece(e){return c.toPiece(e)}}exports.PieceEmojis=c;
},{"./piece-emoji":"V0Ji"}],"r7z1":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),t=this&&this.__exportStar||function(t,r){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(r,i)||e(r,t,i)};Object.defineProperty(exports,"__esModule",{value:!0}),t(require("./emoji-pieces-configuration"),exports),t(require("./piece-emoji"),exports),t(require("./piece-to-emoji-mapper"),exports);
},{"./emoji-pieces-configuration":"CUyU","./piece-emoji":"V0Ji","./piece-to-emoji-mapper":"oRRl"}],"FSNu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EmojiChessBoardGenerator=void 0;var e=require("@ddd-es-ts-chess/chess-piece-emoji"),i=require("@ddd-es-ts-chess/chess-domain"),r=require("@ddd-es-ts-chess/chess-piece-emoji"),o=function(){function o(i){void 0===i&&(i=e.EMOJIS_START_CONFIG),this.piecesConfiguration=i}return o.prototype.generate=function(){var o=this,s={};return Object.keys(this.piecesConfiguration).map(function(e){return e}).filter(function(e){return 0!==e}).map(function(e){return e}).forEach(function(t){o.piecesConfiguration[t].forEach(function(o,n){var a=i.Square.uppercaseAvailableColumns[n];if(e.isPieceEmoji(o)){var c=r.PieceEmojis.toPiece(o),u=i.Square.at(i.Column.fromCharacter(a),i.Row.fromNumber(t));s[u.algebraicNotation]=i.Pieces.getBy(c.name,i.Side.byName(c.side))}})}),i.ChessBoard.withPieces(s)},o}();exports.EmojiChessBoardGenerator=o;
},{"@ddd-es-ts-chess/chess-piece-emoji":"r7z1","@ddd-es-ts-chess/chess-domain":"FWrI"}],"KOi1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ChessBoardPresenter=void 0;var e=require("@ddd-es-ts-chess/ddd-building-blocks-domain"),i=require("@ddd-es-ts-chess/chess-domain"),t=function(){function t(e,i){var t=this;this.model=e,this.view=i,this.selectedPieceOn=void 0,this.eventHandlers={PieceWasCaptured:function(e){var i=e.data;return t.view.removeCapturedPiece(i.onSquare,i.piece)},PieceWasMoved:function(e){var i=e.data;return t.view.moveSelectedPiece(i)},PieceWasNotMoved:function(){return t.view.hideSelectedPieceAvailableMoves()},KingWasChecked:function(e){var i=e.data;return t.view.checkKingOn(i.onSquare)},KingWasUnchecked:function(){return t.view.uncheckKing()},PawnPromotionWasEnabled:function(e){var i=e.data;return t.view.showPawnPromotionSelection(i.onSquare,i.pawn.side)},PawnWasPromoted:function(e){var i=e.data;return t.view.changePawnToPromoted(i.onSquare,{name:i.to.name,side:i.to.side})},ChessGameFinished:function(e){var i=e.data;return t.view.showGameResult(i.result)},Any:function(e){console.log(e),t.view.showCurrentSide(t.model.currentSide)}},this.handle=function(e){var i=t.eventHandlers[e.eventType];i&&i(e),t.eventHandlers.Any(e)}}return t.prototype.loadChessBoard=function(){var e=this.model.board;this.view.showChessBoard(e);var i=e.checkedKing();i&&this.view.checkKingOn(i.square),this.view.showCurrentSide(this.model.currentSide)},t.prototype.selectSquare=function(t){if(e.isNotDefined(this.selectedPieceOn)){this.selectedPieceOn=t;var n=this.model.movesForPiece(t,this.model.currentSide);n&&n.length>0?(this.view.showSelectedPieceAvailableMoves(n),this.view.showSelectedPieceOn(t)):(this.view.hideSelectedPieceAvailableMoves(),this.view.notShowSelectedPiece(),this.selectedPieceOn=void 0)}else this.model.movePiece({by:i.PlayerId.of(this.model.currentSide),from:this.selectedPieceOn,to:t}).handleEvents(this.handle),this.view.notShowSelectedPiece(),this.selectedPieceOn=void 0},t.prototype.promotePawn=function(e,i,t){this.model.promotePawn(e,i,t).handleEvents(this.handle),this.view.showCurrentSide(this.model.currentSide)},t}();exports.ChessBoardPresenter=t;
},{"@ddd-es-ts-chess/ddd-building-blocks-domain":"snZV","@ddd-es-ts-chess/chess-domain":"FWrI"}],"VPhh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ChessGameHistoryPresenter=void 0;var e=function(){function e(e,t){this.model=e,this.view=t}return e.prototype.undoLastMove=function(){this.model.undoLastMove(),this.view.onLastMoveUndone()},e}();exports.ChessGameHistoryPresenter=e;
},{}],"e5Z8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SystemTimeProvider=void 0;var e=function(){function e(){}return e.prototype.currentDate=function(){return new Date},e}();exports.SystemTimeProvider=e;
},{}],"r1N5":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var s=e(require("./chess/presentation/web-chess-game-view")),r=require("./chess/infrastructure/board/emoji-chess-board-generator"),t=require("./chess/presentation/chess-board-presenter"),i=require("./chess/presentation/chess-game-history-presenter"),a=require("./chess/infrastructure/time/system-time-provider"),d=require("@ddd-es-ts-chess/chess-domain"),n=require("@ddd-es-ts-chess/chess-domain"),o=require("@ddd-es-ts-chess/chess-domain"),h=require("@ddd-es-ts-chess/chess-domain"),c=new r.EmojiChessBoardGenerator,u=c.generate(),m=o.ChessGame.with({timeProvider:new a.SystemTimeProvider});m.start({chessBoard:u,id:n.ChessGameId.generate(),startSide:d.Side.WHITE,players:{white:h.PlayerId.of("white"),black:h.PlayerId.of("black")}});var w=new s.default(function(e){return new t.ChessBoardPresenter(m,e)},function(e){return new i.ChessGameHistoryPresenter(m,e)});window.view=w,window.chessGame=m;
},{"./chess/presentation/web-chess-game-view":"B5NP","./chess/infrastructure/board/emoji-chess-board-generator":"FSNu","./chess/presentation/chess-board-presenter":"KOi1","./chess/presentation/chess-game-history-presenter":"VPhh","./chess/infrastructure/time/system-time-provider":"e5Z8","@ddd-es-ts-chess/chess-domain":"FWrI"}]},{},["r1N5"], null)
//# sourceMappingURL=main.12fc1ae2.js.map